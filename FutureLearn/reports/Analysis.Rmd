---
title: "Analysis"
author: "Graham Cole"
date: "20/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath('..'))
knitr::opts_chunk$set(out.width='750px', dpi=200)
```

```{r load project, include=FALSE}
library(ProjectTemplate)
load.project()  
```

# Analysis of Demographic Information by Archetype Classificiation 

The key components of information pertaining to learner demographic are:

* Gender
* Age
* Employment Status

For expendiency, I have discounted the following componets from my demographic analysis.  

* Education Level
* Employment Sector 
* Country of Residence 

Using the "enrol_leave_arch" data set, I undertook to investigate each of these areas to identify trends.  

### Age by Arcehtype Class 

``` {r age by archetype, include=TRUE, echo=FALSE}
 #relative proportion age by archetype
arch_age_prop=enrol_leave_arch %>% 
  filter(age_range!="Unknown") %>% 
  group_by(age_range, archetype) %>% 
  summarise(n=n()) %>% 
  mutate(freq=n/sum(n))

#age proportion 
ggplot(data=arch_age_prop)+geom_bar(aes(x=age_range, y=n, fill = factor(arch_age_prop$archetype)),stat = "identity")
```

```{r age percentage, include=FALSE, echo=FALSE}
V46_55=arch_age_prop %>%
  filter(age_range=="46-55", archetype=="Vitalisers")%>% 
  pull(var=-1)
V65=arch_age_prop %>% 
  filter(age_range==">65", archetype=="Vitalisers") %>% 
  pull(var=-1)
E26_35=arch_age_prop %>% 
  filter(age_range=="26-35", archetype=="Explorers") %>% 
  pull(var=-1)
E36_45=arch_age_prop %>% 
  filter(age_range=="36-45", archetype=="Explorers") %>% 
  pull(var=-1)
maxage=arch_age_prop %>% 
  filter(age_range=="46-55") %>% 
  pull(var=-2)

```

Data has been provided for `r sum(arch_age_prop[,3])` learners. 

As shown in the graph above, the majority of learners fall within the 46-55 age range (`r sum(maxage)` learners)  

Vitalisers make up the majority of 46-55 (`r  round(V46_55*100,digits=1)`%) and >65 (`r round(V65*100,digits=1)`%) age ranges.  Explorers are most represented within the 26-35 (`r round(E26_35*100,digits=1)`%) and 36-45 (`r round(E36_45*100,digits=1)`%) age ranges.

## Gender by Archetype Class

```{r gender by arch, inlcude=TRUE, echo=FALSE}

#grouping by archetype and gender 
arch_gender_prop=enrol_leave_arch %>% 
  filter(gender!="Unknown") %>% 
  group_by(archetype, gender) %>% 
  summarise(n=n()) %>% 
  mutate(freq=n/sum(n))

ggplot(data=arch_gender_prop)+geom_bar(aes(x=archetype, y=n, fill = factor(arch_gender_prop$gender)),stat = "identity")+theme(axis.text.x = element_text(angle = 90))
```

```{r inline gender, include=FALSE, echo=FALSE}
#explorers male
E_M=arch_gender_prop %>% 
  filter(gender=="male", archetype=="Explorers") %>% 
  pull(var=4)

#advancers male
A_M=arch_gender_prop %>% 
  filter(gender=="male", archetype=="Advancers") %>% 
  pull(var=4)

#vitalisers female
V_F=arch_gender_prop %>% 
  filter(gender=="female", archetype=="Vitalisers") %>% 
  pull(var=4)

#fixers female
F_F=arch_gender_prop %>% 
  filter(gender=="female", archetype=="Fixers") %>% 
  pull(var=4)

male=arch_gender_prop %>% 
  filter(gender=="male") %>% 
  pull(var=3)
 
female=arch_gender_prop %>% 
  filter(gender=="female") %>% 
  pull(var=3)  

```

Data has been provided for `r sum(arch_gender_prop[,3])` learners. 

The graph above shows that the majority of Advancers (`r round(A_M*100, digits=1)`%) and Explorers (`r round(E_M*100, digits=1)`%) are male where as the majority of Vitalisers (`r round(V_F*100, digits=1)`%) and Fixers (`r round(F_F*100, digits=1)`%) are female. 

The proportion of male to female learners accross the sample data is `r sum(male)`/ `r sum(female)`.

## Employment Status by Archteype Class 

``` {r employment status by arch, include=TRUE, echo=FALSE}
#grouping by archetype and work status 
arch_empl_status=enrol_leave_arch %>% 
  filter(employment_status!="Unknown") %>% 
  group_by(archetype,employment_status) %>% 
  summarise(n=n()) %>% 
  mutate(freq=n/sum(n))
ggplot(data=arch_empl_status)+geom_bar(aes(x=employment_status, y=n, fill = factor(arch_empl_status$archetype)),stat = "identity") +theme(axis.text.x = element_text(angle = 90))

se_vital=arch_empl_status %>% 
  filter(archetype=="Vitalisers", employment_status=="self_employed") %>% 
  pull(var=4)
```

Data was provided for `r sum(arch_empl_status$n)` learners. 

The strongest signal in this data is found in the "Self Employed" category, with `r round(se_vital*100, digits=1)`% identifying as part of hte Vitaliser archetype class.  

# Analysis of Progress Data by Archetype Class 

Data has been collected recording the stages completed by each learner through the course.  Combining this data togehter with the archetype classifcations and segregating by year produced the "step_arch_2017" and step_arch_2018" data sets, on which I conducted my analysis.  

## Course Progress by Archetype Class - 2017 

``` {r steps 2017, include=TRUE, echo=FALSE}

step_by_arch_2017=step_arch_prog_2017 %>% 
  group_by(archetype, learner_id) %>% 
  summarise("total_progress"=sum(progress))

ggplot(step_by_arch_2017, aes(x = as.factor(archetype),y= step_by_arch_2017$total_progress )) + geom_boxplot()
```

Data was provided for `r nrow(step_by_arch_2017)` leaners.

```{r summary tables 2017 hobbyists, include=TRUE, echo=FALSE}

hobby_step_2017=step_by_arch_2017 %>% 
  filter(archetype=="Hobbyists") 
hobby_vec=pull(hobby_step_2017,var=3)
```

At first reading, learners identifying as part of the Hobbyist archetype perform particularly well, completing on average `r round(mean(hobby_vec), digits=1)` steps within the course, with a median step count of `r median(hobby_vec)`.  The full summary is shown below:
``` {r hobbyists summary, include=TRUE, echo=FALSE}
  summary(hobby_vec)
```

```{r summary tables 2017 preparers, include=TRUE, echo=FALSE}

prep_step_2017=step_by_arch_2017 %>% 
  filter(archetype=="Preparers") 
prep_vec=pull(prep_step_2017,var=3)
```

Learners identifying as part of the Preparers archetype also perform well, completing on average `r round(mean(prep_vec), digits=1)` steps.  Again, the full summary is shown below:
``` {r preparers summary, include=TRUE, echo=FALSE}
  summary(prep_vec)
```

The outlying values shown on the graph are anomalous and further work is required to scruitinise and discount these on a case by case basis.  

## Course Progress by Archetype Class - 2018

```{r steps 2018, include=TRUE, echo=FALSE}

step_by_arch_2018=step_arch_prog_2018 %>%
   group_by(archetype, learner_id) %>% 
   summarise("total_progress" = sum(progress))

ggplot(step_by_arch_2018, aes(x = as.factor(archetype), y = step_by_arch_2018$total_progress)) + geom_boxplot()
```

Data was provided for `r nrow(step_by_arch_2018)` learners.

```{r summary tables 2018 preparers, include=TRUE, echo=FALSE}

prep_step_2018=step_by_arch_2018 %>% 
  filter(archetype=="Preparers") 
prep_vec_18=pull(prep_step_2018,var=3)

hobby_step_2018=step_by_arch_2018 %>% 
  filter(archetype=="Hobbyists") 
hobby_vec_18=pull(hobby_step_2018,var=3)


```

Comparing this data to that seen in 2017, there has been a significant decrease in the median number of course steps completed accross all archetype classess.  Looking again at the Hobbyist and Performers archetypes, we see that the average number of steps completed (`r round(mean(hobby_vec_18), digits=1)` and `r round(mean(prep_vec_18), digits=1)` respectively).   












